# Distributed Linear System Solver

Distributed Solver — это распределённый решатель систем линейных алгебраических уравнений (СЛАУ) методом Гаусса с современным WPF-интерфейсом.

## Архитектура

Проект состоит из следующих компонентов:

- **DistributedSolver.Core** — ядро: модели данных, DTO, численные алгоритмы (линейный и многопоточный метод Гаусса), генераторы матриц, утилиты сжатия.
- **DistributedSolver.Coordinator** — HTTP-координатор, принимающий задачи от клиента, балансирующий нагрузку между воркерами и отслеживающий прогресс выполнения.
- **DistributedSolver.Worker** — вычислительные узлы, выполняющие задачи локально с использованием многопоточности.
- **DistributedSolver.Client** — WPF-клиент с современным интерфейсом для управления системой, мониторинга задач, генерации матриц и сравнения методов.
- **DistributedSolver.Tests** — модульные, интеграционные и нагрузочные тесты.

## Технический стек

- **.NET 8.0** / **ASP.NET Core** / **WPF**
- **Newtonsoft.Json** + кастомное сжатие (Brotli/GZip)
- **Docker** + **docker-compose** для развертывания
- **xUnit** + **FluentAssertions** для тестирования

## Структура решения

```
DistributedSolver.sln
├── DistributedSolver.Core          # Ядро системы
├── DistributedSolver.Coordinator    # HTTP-координатор
├── DistributedSolver.Worker        # Вычислительные узлы
├── DistributedSolver.Client        # WPF-клиент
├── DistributedSolver.Tests         # Тесты
└── datasets/                        # Примеры данных
    ├── matrix_*.txt                 # Матрицы
    ├── freeterms_*.txt              # Свободные члены
    └── nodes*.txt                   # Конфигурации узлов
```

## Быстрый старт

### Сборка проекта

```bash
dotnet build DistributedSolver.sln
```

### Запуск через Docker (рекомендуется)

```bash
docker-compose up --build
```

Запустятся:
- координатор на `http://localhost:5000`
- шесть воркеров на портах `6001-6006`

### Ручной запуск

**Терминал 1 — координатор:**
```bash
dotnet run --project DistributedSolver.Coordinator
```

**Терминалы 2-7 — воркеры:**
```bash
dotnet run --project DistributedSolver.Worker -- 6001
dotnet run --project DistributedSolver.Worker -- 6002
# ... и т.д.
```

**Клиент:**
```bash
dotnet run --project DistributedSolver.Client
```

Или используйте `DistributedSolver.Client\Launch_Client.bat`.

## Интерфейс клиента

WPF-приложение с современным дизайном:

- **Левая панель:**
  - Загрузка данных (матрица, вектор B, узлы, воркеры)
  - Статистика (размер системы, количество узлов)
  - Генератор матриц (быстрая генерация и расширенный диалог)
  - Управление вычислениями (распределённый/линейный запуск, сравнение методов, тест воркеров, отмена)
  - Сохранение результатов

- **Правая секция:**
  - Верхняя панель: статус, время выполнения, прогресс
  - Вкладки:
    - **Сравнение** — таблица результатов с метриками производительности
    - **Решение** — вектор решения с научной и обычной нотацией
    - **Узлы** — мониторинг задач на воркерах с прогресс-барами
    - **Логи** — системный лог с временными метками

## API координатора

| Метод | Маршрут | Описание |
|-------|---------|----------|
| `POST` | `/api/Coordinator/register` | Регистрация воркера |
| `GET` | `/api/Coordinator/workers` | Список активных воркеров |
| `POST` | `/api/Coordinator/solve?method=distributed\|linear` | Постановка задачи на решение |
| `POST` | `/api/Coordinator/solve-multiple` | Пакетный запуск задач на нескольких воркерах |
| `GET` | `/api/Coordinator/tasks/status?taskIds=1&taskIds=2` | Статус задач |
| `GET` | `/api/Coordinator/tasks/{id}/result` | Получение полного результата задачи |
| `POST` | `/api/Coordinator/tasks/cleanup?olderThanMinutes=60` | Очистка завершённых задач |
| `GET` | `/api/Coordinator/health` | Проверка работоспособности |

## API воркера

| Метод | Маршрут | Описание |
|-------|---------|----------|
| `POST` | `/api/Computation/solve-linear` | Решение СЛАУ линейным методом Гаусса |
| `POST` | `/api/Computation/solve-distributed` | Решение СЛАУ многопоточным методом Гаусса |
| `GET` | `/api/Computation/health` | Проверка работоспособности |

## Формат данных

### Матрица системы

Текстовый файл, каждая строка содержит элементы строки матрицы, разделённые пробелами или табуляцией.

**Пример (3×3):**
```
2  1 -1
-3 -1  2
-2  1  2
```

### Свободные члены

Текстовый файл, каждая строка содержит один свободный член.

**Пример:**
```
8
-11
-3
```

### Файл узлов

Текстовый файл со списком узлов в формате `адрес:порт`, по одному на строку. Строки, начинающиеся с `#`, игнорируются.

**Пример:**
```
localhost:6001
localhost:6002
localhost:6003
```

## Генератор матриц

Клиент поддерживает генерацию матриц трёх типов:

1. **Хорошо обусловленная (диагонально доминирующая)** — рекомендуется для стабильности решения
2. **Случайная матрица** — полностью случайные элементы в заданном диапазоне
3. **С известным решением** — для проверки точности алгоритма

Размер матрицы: от 1 до 50000.

## Тестирование

### Запуск всех тестов

```bash
dotnet test DistributedSolver.Tests/DistributedSolver.Tests.csproj
```

### Запуск по категориям

```bash
# Модульные тесты
dotnet test --filter "FullyQualifiedName~UnitTests"

# Интеграционные тесты
dotnet test --filter "FullyQualifiedName~IntegrationTests"

# Нагрузочные тесты
dotnet test --filter "FullyQualifiedName~LoadTests"
```

## Документация

- **[DOCKER.md](DOCKER.md)** — подробное руководство по развертыванию в Docker
- **[INSTRUCTIONS.md](INSTRUCTIONS.md)** — детальные инструкции по использованию и устранению неполадок

## Производительность

- **Распределённый метод** эффективен для систем размером более 500 неизвестных
- **Линейный метод** может быть быстрее для малых систем (< 100) из-за отсутствия накладных расходов
- Рекомендуется использовать 3-6 воркеров для оптимальной производительности
- Многопоточный метод использует все доступные ядра процессора на каждом воркере

## Лицензия

Учебный проект Distributed Solver, 2024–2025. Свободно для исследований и доработок.
